{"remainingRequest":"/mnt/d/work/partyplay/node_modules/ts-loader/index.js??ruleSet[1].rules[0].use[1]!/mnt/d/work/partyplay/src/utils/AppStatesHandler.ts","dependencies":[{"path":"/mnt/d/work/partyplay/src/utils/AppStatesHandler.ts","mtime":1606122419362},{"path":"/mnt/d/work/partyplay/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/mnt/d/work/partyplay/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwpleHBvcnRzLm1hcCA9IGV4cG9ydHMuQXBwU3RhdGVzSGFuZGxlciA9IGV4cG9ydHMuU3RhdGVNYXBBY3Rpb24gPSBleHBvcnRzLlN0YXRlTWFwcGluZyA9IGV4cG9ydHMuQmFzZUFwcFN0YXRlID0gdm9pZCAwOwpjbGFzcyBCYXNlQXBwU3RhdGUgewogICAgX19zZXRJbnN0YW5jZShpbnN0YW5jZSkgewogICAgICAgIHRoaXMuX19pbnN0YW5jZSA9IGluc3RhbmNlOwogICAgfQogICAgX191cGRhdGUoKSB7CiAgICAgICAgdGhpcy5fX2luc3RhbmNlLnNldFN0YXRlKHRoaXMpOwogICAgfQp9CmV4cG9ydHMuQmFzZUFwcFN0YXRlID0gQmFzZUFwcFN0YXRlOwpjbGFzcyBTdGF0ZU1hcHBpbmcgewogICAgY29uc3RydWN0b3Ioc3RhdGVNYXAsIHN0YXRlKSB7CiAgICAgICAgdGhpcy5zdGF0ZU1hcCA9IHN0YXRlTWFwLnNwbGl0KCIuIik7CiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgfQogICAgZ2V0UHJvcGVydHkodGFyZ2V0LCBkZXB0aCA9IDApIHsKICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PSAidW5kZWZpbmVkIikKICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy5zdGF0ZTsKICAgICAgICBpZiAoZGVwdGggPT0gdGhpcy5zdGF0ZU1hcC5sZW5ndGggLSAxKQogICAgICAgICAgICByZXR1cm4gdGFyZ2V0W3RoaXMuc3RhdGVNYXBbZGVwdGhdXTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KHRhcmdldFt0aGlzLnN0YXRlTWFwW2RlcHRoXV0sIGRlcHRoICsgMSk7CiAgICB9CiAgICBmb3JQYXRoKHN0YXRlTWFwKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdGF0ZU1hcHBpbmcoc3RhdGVNYXAsIHRoaXMuc3RhdGUpOwogICAgfQogICAgYXBwZW5kUGF0aChzdGF0ZU1hcCkgewogICAgICAgIHJldHVybiBuZXcgU3RhdGVNYXBwaW5nKFsuLi50aGlzLnN0YXRlTWFwLCBzdGF0ZU1hcF0uam9pbigiLiIpLCB0aGlzLnN0YXRlKTsKICAgIH0KfQpleHBvcnRzLlN0YXRlTWFwcGluZyA9IFN0YXRlTWFwcGluZzsKY2xhc3MgU3RhdGVNYXBBY3Rpb24gewogICAgY29uc3RydWN0b3IobWFwLCBzdGF0ZSkgewogICAgICAgIHRoaXMubWFwID0gbWFwOwogICAgICAgIGlmIChzdGF0ZSkKICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgICAgIGVsc2UgaWYgKG1hcC5zdGF0ZSkKICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IG1hcC5zdGF0ZTsKICAgIH0KICAgIGdldFN0YXRlKCkgewogICAgICAgIHJldHVybiB0aGlzLm1hcC5nZXRQcm9wZXJ0eSh0aGlzLnN0YXRlKTsKICAgIH0KICAgIF9nZXRGdW5jKG5hbWUpIHsKICAgICAgICByZXR1cm4gdGhpc1tuYW1lXS5iaW5kKHRoaXMpOwogICAgfQp9CmV4cG9ydHMuU3RhdGVNYXBBY3Rpb24gPSBTdGF0ZU1hcEFjdGlvbjsKY2xhc3MgQXBwU3RhdGVzQ2hpbGRIYW5kbGVyIHsKICAgIGNvbnN0cnVjdG9yKGFuY2VzdG9yKSB7CiAgICAgICAgdGhpcy5fX2FuY2VzdG9yID0gYW5jZXN0b3I7CiAgICAgICAgdGhpcy5fX2luc3RhbmNlID0gYW5jZXN0b3IuX19pbnN0YW5jZTsKICAgIH0KICAgIGdldCh0YXJnZXQsIHAsIHJlY2VpdmVyKSB7CiAgICAgICAgbGV0IHJlcyA9IHRhcmdldFtwXTsKICAgICAgICBpZiAodHlwZW9mIHJlcyA9PSAidW5kZWZpbmVkIikKICAgICAgICAgICAgcmVzID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRhcmdldClbcF07CiAgICAgICAgaWYgKHR5cGVvZiByZXMgPT0gImZ1bmN0aW9uIikKICAgICAgICAgICAgcmVzID0gcmVzLmJpbmQodGFyZ2V0KTsKICAgICAgICBpZiAodHlwZW9mIHJlcyA9PSAib2JqZWN0IikKICAgICAgICAgICAgcmVzID0gbmV3IFByb3h5KHJlcywgbmV3IEFwcFN0YXRlc0NoaWxkSGFuZGxlcih0aGlzLl9fYW5jZXN0b3IpKTsKICAgICAgICByZXR1cm4gcmVzOwogICAgfQogICAgc2V0KHRhcmdldCwgcCwgdmFsdWUsIHJlY2VpdmVyKSB7CiAgICAgICAgdGFyZ2V0W3BdID0gdmFsdWU7CiAgICAgICAgaWYgKHRoaXMuX19pbnN0YW5jZSAmJiB0eXBlb2YgdGhpcy5fX2luc3RhbmNlLnNldFN0YXRlID09ICJmdW5jdGlvbiIpCiAgICAgICAgICAgIHRoaXMuX19hbmNlc3Rvci5fX3VwZGF0ZSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CmNsYXNzIEFwcFN0YXRlc0hhbmRsZXIgewogICAgZ2V0KHRhcmdldCwgcCwgcmVjZWl2ZXIpIHsKICAgICAgICBsZXQgcmVzID0gdGFyZ2V0W3BdOwogICAgICAgIGlmICh0eXBlb2YgcmVzID09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICByZXMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KVtwXTsKICAgICAgICBpZiAodHlwZW9mIHJlcyA9PSAiZnVuY3Rpb24iKQogICAgICAgICAgICByZXMgPSByZXMuYmluZCh0YXJnZXQpOwogICAgICAgIGlmICh0eXBlb2YgcmVzID09ICJvYmplY3QiKQogICAgICAgICAgICByZXMgPSBuZXcgUHJveHkocmVzLCBuZXcgQXBwU3RhdGVzQ2hpbGRIYW5kbGVyKHRhcmdldCkpOwogICAgICAgIHJldHVybiByZXM7CiAgICB9CiAgICBzZXQodGFyZ2V0LCBwLCB2YWx1ZSwgcmVjZWl2ZXIpIHsKICAgICAgICB0YXJnZXRbcF0gPSB2YWx1ZTsKICAgICAgICBpZiAodGFyZ2V0Ll9faW5zdGFuY2UpCiAgICAgICAgICAgIHRhcmdldC5fX3VwZGF0ZSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CmV4cG9ydHMuQXBwU3RhdGVzSGFuZGxlciA9IEFwcFN0YXRlc0hhbmRsZXI7CmZ1bmN0aW9uIG1hcChwYXRoLCBhcHBTdGF0ZSkgewogICAgcmV0dXJuIG5ldyBTdGF0ZU1hcHBpbmcocGF0aCwgbmV3IFByb3h5KGFwcFN0YXRlLCBuZXcgQXBwU3RhdGVzSGFuZGxlcigpKSk7Cn0KZXhwb3J0cy5tYXAgPSBtYXA7Cg=="},{"version":3,"file":"/mnt/d/work/partyplay/src/utils/AppStatesHandler.ts","sourceRoot":"","sources":["/mnt/d/work/partyplay/src/utils/AppStatesHandler.ts"],"names":[],"mappings":"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","sourcesContent":["import React from \"react\"\n\nexport class BaseAppState{\n    __instance: React.Component;\n\n    __setInstance(instance: React.Component): void {\n        this.__instance = instance;\n    }\n\n    __update(){\n        this.__instance.setState(this);\n    }\n}\n\nexport class StateMapping<T>{\n    constructor(stateMap: string, state?: BaseAppState){\n        this.stateMap = stateMap.split(\".\");\n        this.state = state;\n    }\n    stateMap: string[];\n    state: BaseAppState;\n    getProperty(target?: any, depth: number = 0): T{\n        if(typeof target == \"undefined\") target = this.state;\n        if(depth==this.stateMap.length-1) return target[this.stateMap[depth]] as T;\n        else return this.getProperty(target[this.stateMap[depth]],depth+1)\n    }\n    forPath<P>(stateMap: string):StateMapping<P>{\n        return new StateMapping<P>(stateMap,this.state);\n    }\n    appendPath<P>(stateMap: string):StateMapping<P>{\n        return new StateMapping<P>([...this.stateMap,stateMap].join(\".\"),this.state);\n    }\n}\n\nexport class StateMapAction<T> {\n    constructor(map: StateMapping<T>, state?: BaseAppState) {\n        this.map = map;\n        if(state) this.state = state;\n        else if (map.state) this.state = map.state;\n    }\n    map: StateMapping<T>;\n    state: BaseAppState;\n    getState():T{\n        return this.map.getProperty(this.state) as T;    \n    }\n    _getFunc(name: string){\n        return ((this as any)[name] as Function).bind(this);\n    }\n}\n\nclass  AppStatesChildHandler implements ProxyHandler<any> {\n    __instance: any;\n    __ancestor: BaseAppState;\n\n    constructor(ancestor: BaseAppState){\n        this.__ancestor = ancestor;\n        this.__instance = ancestor.__instance;\n    }\n\n    get(target: any, p: PropertyKey, receiver: any) {\n        let res = target[p];\n        if (typeof res == \"undefined\")\n            res = Object.getPrototypeOf(target)[p];\n        if (typeof res == \"function\")\n            res = res.bind(target);\n        if (typeof res == \"object\")\n            res = new Proxy(res, new AppStatesChildHandler(this.__ancestor))\n        return res;\n    }\n    set(target: any, p: PropertyKey, value: any, receiver: any): boolean {\n        (target as any)[p] = value;\n        if (this.__instance && typeof this.__instance.setState == \"function\") \n            this.__ancestor.__update();\n        return true;\n    }\n}\n\nexport class AppStatesHandler<T extends BaseAppState> implements ProxyHandler<T> {\n    get(target: T, p: PropertyKey, receiver: any) {\n        let res = (target as any)[p];\n        if (typeof res == \"undefined\")\n            res = Object.getPrototypeOf(target)[p];\n        if (typeof res == \"function\")\n            res = res.bind(target);\n        if (typeof res == \"object\")\n            res = new Proxy(res, new AppStatesChildHandler(target));\n        return res;\n    }\n    set(target: T, p: PropertyKey, value: any, receiver: any): boolean {\n        (target as any)[p] = value;\n        if (target.__instance) target.__update();\n        return true;\n    }\n}\n\nexport function map<T>(path: string,appState: BaseAppState):StateMapping<T> {\n    return new StateMapping<T>(path,new Proxy(appState,new AppStatesHandler<BaseAppState>()));\n}\n"]}]}