{"remainingRequest":"/mnt/d/work/partyplay/node_modules/ts-loader/index.js??ruleSet[1].rules[0].use[1]!/mnt/d/work/partyplay/src/reactapp/lib/wsapp-client.ts","dependencies":[{"path":"/mnt/d/work/partyplay/src/reactapp/lib/wsapp-client.ts","mtime":1606130307214},{"path":"/mnt/d/work/partyplay/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/mnt/d/work/partyplay/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwp2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsKICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfQogICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQogICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH0KICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQogICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsKICAgIH0pOwp9OwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwpleHBvcnRzLldzYXBwQ2xpZW50ID0gdm9pZCAwOwpjbGFzcyBXc2FwcENsaWVudFRyaWdnZXJzIHsKfQpjbGFzcyBXc2FwcENsaWVudCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICB0aGlzLnRyaWdnZXIgPSBuZXcgV3NhcHBDbGllbnRUcmlnZ2VycygpOwogICAgICAgIHRoaXMuZGVmYXVsdEhhbmRsZXIgPSBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICB9OwogICAgICAgIGNvbnN0IHRoZWNsaWVudCA9IHRoaXM7CiAgICAgICAgdGhpcy5fX2luaXR3cygpOwogICAgICAgIHRoaXMuX193cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7CiAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5uYW1lKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHRoaXMuX193cy5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJjb25uZWN0aW9uIGNsb3NlZCIpOwogICAgICAgICAgICAvLyB0aGlzLl9faW5pdHdzKCk7CiAgICAgICAgfTsKICAgIH0KICAgIF9faW5pdHdzKCkgewogICAgICAgIHRoaXMuX193cyA9IG5ldyBXZWJTb2NrZXQoIndzOi8vIiArICIxOTIuMTY4LjEwMC45OjMwMDAiICsgIi93c3JwYyIpOwogICAgfQogICAgX19jYWxsKG5hbWUsIHBhcmFtZXRlcnMpIHsKICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgewogICAgICAgICAgICBjb25zdCB3cyA9IHRoaXMuX193czsKICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHYsIGopID0+IHsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHdhaXRSZWFkeSgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAod3MucmVhZHlTdGF0ZSA9PSB3cy5DT05ORUNUSU5HKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQod2FpdFJlYWR5LCAxMDApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdhaXRSZWFkeSgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5fX3dzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBwYXJhbWV0ZXJzIH0pKTsKICAgICAgICB9KTsKICAgIH0KfQpleHBvcnRzLldzYXBwQ2xpZW50ID0gV3NhcHBDbGllbnQ7CmxldCBzZGsgPSBuZXcgV3NhcHBDbGllbnQoKTsKZXhwb3J0cy5kZWZhdWx0ID0gc2RrOwpjb25zdCB3ID0gd2luZG93OwppZiAodykgewogICAgdy53c2FwcCA9IHNkazsKfQo="},{"version":3,"file":"/mnt/d/work/partyplay/src/reactapp/lib/wsapp-client.ts","sourceRoot":"","sources":["/mnt/d/work/partyplay/src/reactapp/lib/wsapp-client.ts"],"names":[],"mappings":";;;;;;;;;;;;AAIA,MAAM,mBAAmB;CAExB;AAED,MAAa,WAAW;IAEpB;QAoCA,YAAO,GAAwB,IAAI,mBAAmB,EAAE,CAAC;QAEzD,mBAAc,GAAqB,UAAS,IAAS;YACjD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACtB,CAAC,CAAA;QAvCG,MAAM,SAAS,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,UAAS,KAAU;YACrC,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACpC,QAAO,IAAI,CAAC,IAAI,EAAC;aAEhB;QACL,CAAC,CAAA;QACD,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,UAAS,KAAU;YACnC,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;YACjC,mBAAmB;QACvB,CAAC,CAAA;IACL,CAAC;IAEO,QAAQ;QACZ,IAAI,CAAC,IAAI,GAAG,IAAI,SAAS,CAAC,OAAO,GAAC,oBAAoB,GAAC,QAAQ,CAAC,CAAC;IACrE,CAAC;IAIa,MAAM,CAAC,IAAY,EAAE,UAAe;;YAC9C,MAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;YACrB,MAAM,IAAI,OAAO,CAAC,CAAC,CAAC,EAAC,CAAC,EAAC,EAAE;gBACrB,SAAS,SAAS;oBACd,IAAG,EAAE,CAAC,UAAU,IAAI,EAAE,CAAC,UAAU,EAAC;wBAC9B,UAAU,CAAC,SAAS,EAAC,GAAG,CAAC,CAAC;qBAC7B;yBAAI;wBACD,CAAC,EAAE,CAAC;qBACP;gBACL,CAAC;gBACD,SAAS,EAAE,CAAC;YAChB,CAAC,CAAC,CAAA;YACF,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAC,IAAI,EAAE,UAAU,EAAC,CAAC,CAAC,CAAA;QACtD,CAAC;KAAA;CAUJ;AA9CD,kCA8CC;AAED,IAAI,GAAG,GAAG,IAAI,WAAW,EAAE,CAAC;AAC5B,kBAAe,GAAG,CAAC;AAEnB,MAAM,CAAC,GAAY,MAAiB,CAAC;AACrC,IAAG,CAAC,EAAE;IACF,CAAC,CAAC,KAAK,GAAG,GAAG,CAAC;CACjB","sourcesContent":["declare global {\n    interface Window { wsapp: WsappClient; }\n}\n\nclass WsappClientTriggers {\n\n}\n\nexport class WsappClient {\n\n    constructor(){\n        const theclient = this;\n        this.__initws();\n        this.__ws.onmessage = function(event: any) {\n            const data = JSON.parse(event.data);\n            switch(data.name){\n\n            }\n        }\n        this.__ws.onclose = function(event: any) {\n            console.log(\"connection closed\");\n            // this.__initws();\n        }\n    }\n\n    private __initws() {\n        this.__ws = new WebSocket(\"ws://\"+\"192.168.100.9:3000\"+\"/wsrpc\");\n    }\n\n    private __ws: WebSocket;\n\n    private async __call(name: string, parameters: any){\n        const ws = this.__ws;\n        await new Promise((v,j)=>{\n            function waitReady(){\n                if(ws.readyState == ws.CONNECTING){\n                    setTimeout(waitReady,100);\n                }else{\n                    v();\n                }\n            }\n            waitReady();\n        })\n        this.__ws.send(JSON.stringify({name, parameters}))\n    }\n\n    trigger: WsappClientTriggers = new WsappClientTriggers();\n\n    defaultHandler: (data: any)=>any = function(data: any){\n        console.log(data);\n    }\n\n\n    \n}\n\nlet sdk = new WsappClient();\nexport default sdk;\n\nconst w: Window = (window as Window);\nif(w) {\n    w.wsapp = sdk;\n}\n"]}]}